<p-toast></p-toast>
<p-confirmDialog [style]="{width: '450px'}"></p-confirmDialog>

<div class="button-new-p">
  <button pButton pRipple icon="pi pi-plus" label="Novo" (click)="openDialog()" class="p-button-text"></button>
</div>

<app-searchbox (onSearch)="busca($event)"></app-searchbox>
<p-table [value]="lotacoes">
  <ng-template pTemplate="header">
    <tr>
      <th>#</th>
      <th>Pessoa</th>
      <th>Gabinete</th>
      <th></th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-s>
    <tr>
      <td>{{s.id}}</td>
      <td>{{s.pessoa}}</td>
      <td>{{s.gabinete}}</td>
      <td styleClass="p-button-div" style="text-align: end; margin-right: 30px;">
          <button pButton icon="pi pi-pencil" class="p-button-rounded p-mr-2" style="margin-right: 20px;" (click)="editarLotacao(s)"></button>
          <button pButton icon="pi pi-trash" class="p-button-rounded p-button-warning" (click)="handleDeleteDialog(s)"></button>
      </td>
    </tr>
  </ng-template>
</p-table>


<p-dialog [closable]="false" header="Cadastro de Lotações" [(visible)]="displayLotacao"  [style]="{ width: '40vw' }" styleClass="p-fluid">
  <ng-template pTemplate="content">
    
    <form [formGroup]="formLotacao" (ngSubmit)="onSubmit($event)">
      <div>
        <h5>Pessoa</h5>
        <p-dropdown appendTo="body" [options]="pessoasList" placeholder="Selecionar a pessoa" [showClear]="true"  formControlName="pessoas_id">
        </p-dropdown>
      </div>
      <div [hidden]="pessoas_id.valid || pessoas_id.untouched">  
        <div [hidden]="!pessoas_id.hasError('required')" class="div-red">
          Pessoa é obrigatorio.
        </div>
      </div>

      <div>
        <h5>Gabinete</h5>
        <p-dropdown appendTo="body" [options]="gabinetesList" placeholder="Selecionar o gabinete" [showClear]="true" formControlName="gabinetes_id">
        </p-dropdown>
      </div>
      <div [hidden]="gabinetes_id.valid || gabinetes_id.untouched">  
        <div [hidden]="!gabinetes_id.hasError('required')" class="div-red">
          Gabinete é obrigatorio.
        </div>
      </div>

      <div class="container-buttons">
        <button pButton pRipple type="button" label="Cancelar" style="margin-right: 15px;" class="p-button-text p-button-mod" (click)="hideDialog()"></button>
        <input pButton type="submit" class="p-button-text p-button-mod" [disabled]="!formLotacao.valid" value="Salvar">
      </div>
    </form>

  </ng-template>
</p-dialog>


<p-dialog [closable]="false" header="Exclusão" [(visible)]="displayDelete" [style]="{ width: '30vw' }" styleClass="p-fluid">
  <div style="display: flex;  align-items: center;">
      <button pButton disabled icon="pi pi-exclamation-triangle" class="p-button-rounded p-alert-icon"></button>
      <p style="margin-left: 20px;">Deseja mesmo deletar essa lotação?</p>
  </div>

  <ng-template pTemplate="footer">
          <button pButton label="Não" icon="pi pi-times" class="p-button-text" (click)="hideDeleteDialog()"></button>
          <button pButton label="Sim" icon="pi pi-check" class="p-button-text" (click)="deleteSelectedLotacao()"></button>
  </ng-template>
</p-dialog>
